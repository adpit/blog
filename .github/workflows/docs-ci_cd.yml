# Nama dari workflow, berguna untuk identifikasi di GitHub Actions
name: Docs CI/CD

# Tentukan kapan workflow ini dijalankan
on:
  pull_request:
    paths:
      - '**.md'
      - '**.txt'

# Definisi dari job yang akan dijalankan
jobs:
  check_docs:
    # Jenis runner yang akan digunakan
    runs-on: ubuntu-latest

    # Langkah-langkah yang akan dijalankan dalam job ini
    steps:
      # Mengambil kode dari repositori
      - name: Checkout Repository
        uses: actions/checkout@v2

      # Memastikan file `.txt` dan `.md` tidak konflik
      - name: Check for Merge Conflicts
        run: |
          git fetch origin main:main
          git merge-base --is-ancestor HEAD main
          if [ $? -ne 0 ]; then
            echo "Merge conflict detected. Please resolve."
            exit 1
          fi
          
      # Memastikan format file `.md` (Anda bisa memasukkan pengecekan format di sini)
      - name: Check Markdown Format
        run: |
          # Tambahkan perintah untuk memeriksa format .md di sini
          echo "Pengecekan format Markdown dijalankan. (Tambahkan perintah sesuai kebutuhan)"

      # Jika semua pemeriksaan berhasil, lakukan merge (hanya untuk contoh)
      - name: Auto Merge
        run: |
          git switch main
          git merge --no-ff "${{ github.head_ref }}"
          git push origin main
