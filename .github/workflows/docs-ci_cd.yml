name: Docs CI/CD

# Tentukan kapan workflow ini dijalankan
on:
  push:
    branches:
      - main
    paths:
      - '**.md'
      - '**.txt'

jobs:
  autoPRAndMerge:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Check for Merge Conflicts
        run: |
          git fetch origin main:main
          git merge-base --is-ancestor HEAD main
          if [ $? -ne 0 ]; then
            echo "Merge conflict detected. Please resolve."
            exit 1
          fi

      - name: Check Markdown Format
        run: |
          echo "Pengecekan format Markdown dijalankan. (Tambahkan perintah sesuai kebutuhan)"

      - name: Create Pull Request
        id: cpr
        uses: peter-evans/create-pull-request@v3
        with:
          commit-message: "Automated Docs Update"
          title: "Automated Docs Update"
          body: "Automatic PR to update the docs"
          branch: "auto-update-docs"

      - name: Auto Merge
        if: steps.cpr.outputs.pull-request-number != ''
        run: |
          gh pr merge "${{ steps.cpr.outputs.pull-request-number }}" --merge
